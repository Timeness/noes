<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IP Details</title>
    <link href="https://fonts.googleapis.com/css2?family=Smooch+Sans:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Smooch Sans', sans-serif;
        }
    </style>
</head>
<body>
    <h2>IP Details</h2>
    <p><strong>Public IP Address:</strong> <span id="ip"></span></p>
    <p><strong>Local IP Address:</strong> <span id="local-ip"></span></p>
    <p><strong>Ping:</strong> <span id="ping"></span> ms</p>
    <p><strong>Speed:</strong> <span id="speed"></span></p>
    <p><strong>City:</strong> <span id="city"></span></p>
    <p><strong>Region:</strong> <span id="region"></span></p>
    <p><strong>Country:</strong> <span id="country"></span></p>
    <p><strong>ISP:</strong> <span id="isp"></span></p>
    <p><strong>Host:</strong> <span id="host"></span></p>
    <p><strong>Timezone:</strong> <span id="timezone"></span></p>
    <p><strong>Coordinates:</strong> <span id="lat"></span>, <span id="lon"></span></p>

    <script>
        async function getIPDetails() {
            try {
                let response = await fetch("http://ip-api.com/json/");
                let data = await response.json();
                document.getElementById("ip").innerText = data.query;
                document.getElementById("city").innerText = data.city;
                document.getElementById("region").innerText = data.regionName;
                document.getElementById("country").innerText = data.country;
                document.getElementById("isp").innerText = data.isp;
                document.getElementById("host").innerText = data.as;
                document.getElementById("timezone").innerText = data.timezone;
                document.getElementById("lat").innerText = data.lat;
                document.getElementById("lon").innerText = data.lon;
            } catch (error) {
                console.error("Error fetching IP details:", error);
            }
        }

        function testPing() {
            let start = performance.now();
            fetch("https://www.google.com").then(() => {
                let end = performance.now();
                document.getElementById("ping").innerText = Math.round(end - start);
            });
        }

        function testSpeed() {
            let startTime = new Date().getTime();
            let image = new Image();
            image.src = "https://upload.wikimedia.org/wikipedia/commons/3/3a/Cat03.jpg?t=" + startTime;
            image.onload = function () {
                let endTime = new Date().getTime();
                let speed = (500 / ((endTime - startTime) / 1000)).toFixed(2);
                document.getElementById("speed").innerText = speed + " KB/s";
            };
        }

        function getLocalIP() {
            let pc = new RTCPeerConnection();
            pc.createDataChannel("");
            pc.createOffer().then(offer => pc.setLocalDescription(offer));
            pc.onicecandidate = event => {
                if (event && event.candidate && event.candidate.candidate) {
                    let ipRegex = /([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})/;
                    let match = ipRegex.exec(event.candidate.candidate);
                    if (match) {
                        document.getElementById("local-ip").innerText = match[1];
                    }
                    pc.close();
                }
            };
        }

        getIPDetails();
        testPing();
        testSpeed();
        getLocalIP();
    </script>
</body>
</html>
